<h2>PREVIEW EXCEL FILE</h2><div class="data"><p><a href="<?php echo WEBROOT ?>">Back to Data Files</a></p>
<?php$output = "";$type = "";if ($file != "") {require_once './excel/reader.php';// ExcelFile($filename, $encoding);$data = new Spreadsheet_Excel_Reader();// Set output Encoding.$data->setOutputEncoding('CP1251');/**** if you want you can change 'iconv' to mb_convert_encoding:* $data->setUTFEncoder('mb');***//**** By default rows & cols indeces start with 1* For change initial index use:* $data->setRowColOffset(0);***//****  Some function for formatting output.* $data->setDefaultFormat('%.2f');* setDefaultFormat - set format for columns with unknown formatting** $data->setColumnFormat(4, '%.3f');* setColumnFormat - set format for column (apply only to number fields)***/$data->read('./uploads/' . $file);/* $data->sheets[0]['numRows'] - count rows $data->sheets[0]['numCols'] - count columns $data->sheets[0]['cells'][$i][$j] - data from $i-row $j-column $data->sheets[0]['cellsInfo'][$i][$j] - extended info about cell        $data->sheets[0]['cellsInfo'][$i][$j]['type'] = "date" | "number" | "unknown"        if 'type' == "unknown" - use 'raw' value, because  cell contain value with format '0.00';    $data->sheets[0]['cellsInfo'][$i][$j]['raw'] = value if cell without format     $data->sheets[0]['cellsInfo'][$i][$j]['colspan']     $data->sheets[0]['cellsInfo'][$i][$j]['rowspan'] */error_reporting(E_ALL ^ E_NOTICE);$formatted = "";$type = $data->sheets[0]['cells'][TEMPLATE_TYPE_X][TEMPLATE_TYPE_Y];echo("Filename: " . $file . " (type: " . $type .")<br />\n");echo($data->sheets[0]['numRows'] - TEMPLATE_START_ROW + 1 . " Rows Found<br /><br />\n");for ($i = TEMPLATE_START_ROW; $i <= $data->sheets[0]['numRows']; $i++) {	$formatted .= "</td>\n";	for ($j = 1; $j <= $data->sheets[0]['numCols']; $j++) {		$output .= $data->sheets[0]['cells'][$i][$j];		if ($j < $data->sheets[0]['numCols']) $output .= "|";				if ($j>1) {			$formatted .= "<td>" . $data->sheets[0]['cells'][$i][$j] . "</td>";		}	}	if ($i < $data->sheets[0]['numRows']) $output .= "\n";	$formatted .= "</tr>\n";}?><table><?php	echo $formatted;?></table><?php }?><form method="post" action="<?php echo WEBROOT ?>records/add_multiple_records/"><?php	echo form_hidden('record_type', $type);	echo form_textarea('data', $output);	echo ("<br />\n");	echo form_checkbox('only_new', '1');	echo form_label('Only Process NEW records', 'only_new');	echo ("<br />\n");	echo ("<br />\n");	echo form_submit('submit', 'Create Records');	echo form_reset('submit', 'Reset');	echo form_close(''); ?></div>